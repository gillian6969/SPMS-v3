{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport { ref, computed, onMounted } from 'vue';\nimport { useStore } from 'vuex';\nimport axios from 'axios';\nimport moment from 'moment';\nimport StudentSurveyStat from '../components/StudentSurveyStat.vue';\nexport default {\n  __name: 'CompletedSurveys',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const store = useStore();\n    const surveys = ref([]);\n    const loading = ref(true);\n    const searchQuery = ref('');\n    const selectedSurvey = ref(null);\n    const loadingSurveyDetails = ref(false);\n\n    // Filter surveys based on search query\n    const filteredSurveys = computed(() => {\n      if (!searchQuery.value) return surveys.value;\n      const query = searchQuery.value.toLowerCase();\n      return surveys.value.filter(survey => survey.studentId.toLowerCase().includes(query) || survey.studentName.toLowerCase().includes(query));\n    });\n\n    // Format date\n    const formatDate = dateString => {\n      return moment(dateString).format('MMM D, YYYY h:mm A');\n    };\n\n    // Fetch all submitted surveys\n    const fetchCompletedSurveys = async () => {\n      try {\n        loading.value = true;\n        const token = store.state.auth.token;\n\n        // Get all completed surveys\n        const response = await axios.get('http://localhost:8000/api/survey/submitted', {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        if (response.data) {\n          surveys.value = response.data;\n        }\n      } catch (error) {\n        console.error('Error fetching completed surveys:', error);\n        surveys.value = [];\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // View survey results\n    const viewSurveyResults = async survey => {\n      try {\n        loadingSurveyDetails.value = true;\n        selectedSurvey.value = {\n          ...survey\n        };\n      } catch (error) {\n        console.error('Error fetching survey details:', error);\n      } finally {\n        loadingSurveyDetails.value = false;\n      }\n    };\n\n    // Close modal\n    const closeModal = () => {\n      selectedSurvey.value = null;\n    };\n    onMounted(() => {\n      fetchCompletedSurveys();\n    });\n    const __returned__ = {\n      store,\n      surveys,\n      loading,\n      searchQuery,\n      selectedSurvey,\n      loadingSurveyDetails,\n      filteredSurveys,\n      formatDate,\n      fetchCompletedSurveys,\n      viewSurveyResults,\n      closeModal,\n      ref,\n      computed,\n      onMounted,\n      get useStore() {\n        return useStore;\n      },\n      get axios() {\n        return axios;\n      },\n      get moment() {\n        return moment;\n      },\n      StudentSurveyStat\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","useStore","axios","moment","StudentSurveyStat","store","surveys","loading","searchQuery","selectedSurvey","loadingSurveyDetails","filteredSurveys","value","query","toLowerCase","filter","survey","studentId","includes","studentName","formatDate","dateString","format","fetchCompletedSurveys","token","state","auth","response","get","headers","data","error","console","viewSurveyResults","closeModal"],"sources":["D:/au_dev/client/src/views/CompletedSurveys.vue"],"sourcesContent":["<template>\r\n  <div class=\"completed-surveys\">\r\n    <div class=\"container\">\r\n      <div class=\"d-flex justify-content-between align-items-center mb-4\">\r\n        <h2 class=\"page-title\">\r\n          <i class=\"fas fa-clipboard-check me-2\"></i>\r\n          Completed Surveys\r\n        </h2>\r\n\r\n        <div class=\"filters d-flex align-items-center gap-3\">\r\n          <div class=\"search-box\">\r\n            <div class=\"input-group\">\r\n              <input \r\n                type=\"text\" \r\n                class=\"form-control\" \r\n                placeholder=\"Search student...\" \r\n                v-model=\"searchQuery\"\r\n              >\r\n              <span class=\"input-group-text\">\r\n                <i class=\"fas fa-search\"></i>\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Loading State -->\r\n      <div class=\"text-center my-5\" v-if=\"loading\">\r\n        <div class=\"spinner-border text-primary\" role=\"status\">\r\n          <span class=\"visually-hidden\">Loading...</span>\r\n        </div>\r\n        <p class=\"mt-2\">Loading completed surveys...</p>\r\n      </div>\r\n\r\n      <!-- No Results -->\r\n      <div class=\"card no-results\" v-else-if=\"!loading && filteredSurveys.length === 0\">\r\n        <div class=\"card-body text-center py-5\">\r\n          <i class=\"fas fa-clipboard fa-3x mb-3 text-muted\"></i>\r\n          <h5>No Completed Surveys Found</h5>\r\n          <p class=\"text-muted\">\r\n            {{ searchQuery ? \"No students match your search query.\" : \"No students have completed surveys yet.\" }}\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Results Table -->\r\n      <div class=\"card\" v-else>\r\n        <div class=\"card-body p-0\">\r\n          <div class=\"table-responsive\">\r\n            <table class=\"table table-hover survey-table mb-0\">\r\n              <thead>\r\n                <tr>\r\n                  <th>Student ID</th>\r\n                  <th>Student Name</th>\r\n                  <th>Year & Section</th>\r\n                  <th>Submission Date</th>\r\n                  <th>Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr v-for=\"survey in filteredSurveys\" :key=\"survey._id\">\r\n                  <td>{{ survey.studentDisplayId }}</td>\r\n                  <td>{{ survey.studentName }}</td>\r\n                  <td>{{ survey.year }} - {{ survey.section }}</td>\r\n                  <td>{{ formatDate(survey.updatedAt) }}</td>\r\n                  <td>\r\n                    <div class=\"btn-group\">\r\n                      <button \r\n                        class=\"btn btn-sm btn-outline-primary\" \r\n                        @click=\"viewSurveyResults(survey)\"\r\n                        title=\"View Survey Responses\"\r\n                      >\r\n                        <i class=\"fas fa-eye\"></i>\r\n                      </button>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Survey Details Modal -->\r\n    <div v-if=\"selectedSurvey\" class=\"modal-wrapper\" @click.self=\"closeModal\">\r\n      <div class=\"modal-backdrop\" @click=\"closeModal\"></div>\r\n      <div class=\"modal-dialog modal-lg\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header bg-primary text-white\">\r\n            <h5 class=\"modal-title\">\r\n              <i class=\"fas fa-clipboard-check me-2\"></i>\r\n              Survey Results\r\n            </h5>\r\n            <button type=\"button\" class=\"btn-close btn-close-white\" @click=\"closeModal\"></button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <div v-if=\"loadingSurveyDetails\" class=\"text-center py-5\">\r\n              <div class=\"spinner-border text-primary\" role=\"status\">\r\n                <span class=\"visually-hidden\">Loading survey details...</span>\r\n              </div>\r\n              <p class=\"mt-2\">Loading survey details...</p>\r\n            </div>\r\n            <div v-else>\r\n              <!-- Student Information -->\r\n              <div class=\"student-info mb-4\">\r\n                <h6 class=\"info-title\">Student Information</h6>\r\n                <div class=\"info-content row\">\r\n                  <div class=\"col-md-6\">\r\n                    <p><strong>Student ID:</strong> {{ selectedSurvey.studentDisplayId }}</p>\r\n                    <p><strong>Name:</strong> {{ selectedSurvey.studentName }}</p>\r\n                    <p><strong>Email:</strong> {{ selectedSurvey.email }}</p>\r\n                  </div>\r\n                  <div class=\"col-md-6\">\r\n                    <p><strong>Year:</strong> {{ selectedSurvey.year }}</p>\r\n                    <p><strong>Section:</strong> {{ selectedSurvey.section }}</p>\r\n                    <p><strong>Submitted:</strong> {{ formatDate(selectedSurvey.updatedAt) }}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <!-- Survey Results Chart -->\r\n              <div class=\"survey-chart mb-4\">\r\n                <h6 class=\"info-title\">Survey Response Analysis</h6>\r\n                <div class=\"chart-container\">\r\n                  <StudentSurveyStat :_id=\"selectedSurvey.studentId\" />\r\n                </div>\r\n              </div>\r\n\r\n              <!-- Survey Stats Table -->\r\n              <div v-if=\"selectedSurvey.surveyStats && selectedSurvey.surveyStats.length > 0\" class=\"survey-stats mb-4\">\r\n                <h6 class=\"info-title\">Survey Statistics Summary</h6>\r\n                <div class=\"table-responsive\">\r\n                  <table class=\"table\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th>Problem Type</th>\r\n                        <th>Average Score</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      <tr v-for=\"(stat, index) in selectedSurvey.surveyStats\" :key=\"index\">\r\n                        <td>{{ stat.type }}</td>\r\n                        <td>{{ stat.average.toFixed(2) }}</td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button type=\"button\" class=\"btn btn-secondary\" @click=\"closeModal\">Close</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport axios from 'axios'\r\nimport moment from 'moment'\r\nimport StudentSurveyStat from '../components/StudentSurveyStat.vue'\r\n\r\nconst store = useStore()\r\nconst surveys = ref([])\r\nconst loading = ref(true)\r\nconst searchQuery = ref('')\r\nconst selectedSurvey = ref(null)\r\nconst loadingSurveyDetails = ref(false)\r\n\r\n// Filter surveys based on search query\r\nconst filteredSurveys = computed(() => {\r\n  if (!searchQuery.value) return surveys.value\r\n  \r\n  const query = searchQuery.value.toLowerCase()\r\n  return surveys.value.filter(survey => \r\n    survey.studentId.toLowerCase().includes(query) || \r\n    survey.studentName.toLowerCase().includes(query)\r\n  )\r\n})\r\n\r\n// Format date\r\nconst formatDate = (dateString) => {\r\n  return moment(dateString).format('MMM D, YYYY h:mm A')\r\n}\r\n\r\n// Fetch all submitted surveys\r\nconst fetchCompletedSurveys = async () => {\r\n  try {\r\n    loading.value = true\r\n    const token = store.state.auth.token\r\n    \r\n    // Get all completed surveys\r\n    const response = await axios.get('http://localhost:8000/api/survey/submitted', {\r\n      headers: { 'Authorization': `Bearer ${token}` }\r\n    })\r\n    \r\n    if (response.data) {\r\n      surveys.value = response.data\r\n    }\r\n  } catch (error) {\r\n    console.error('Error fetching completed surveys:', error)\r\n    surveys.value = []\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// View survey results\r\nconst viewSurveyResults = async (survey) => {\r\n  try {\r\n    loadingSurveyDetails.value = true;\r\n    selectedSurvey.value = {\r\n      ...survey\r\n    };\r\n  } catch (error) {\r\n    console.error('Error fetching survey details:', error);\r\n  } finally {\r\n    loadingSurveyDetails.value = false;\r\n  }\r\n};\r\n\r\n// Close modal\r\nconst closeModal = () => {\r\n  selectedSurvey.value = null\r\n}\r\n\r\nonMounted(() => {\r\n  fetchCompletedSurveys()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.completed-surveys {\r\n  padding: 2rem;\r\n  background-color: #f8f9fa;\r\n  min-height: 100vh;\r\n}\r\n\r\n.page-title {\r\n  font-size: 1.75rem;\r\n  font-weight: 700;\r\n  color: #003366;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.search-box .input-group {\r\n  width: 280px;\r\n}\r\n\r\n.search-box .form-control {\r\n  border-right: none;\r\n}\r\n\r\n.search-box .input-group-text {\r\n  background-color: white;\r\n  border-left: none;\r\n}\r\n\r\n.survey-table th {\r\n  font-weight: 600;\r\n  color: #4a5568;\r\n  padding: 1rem;\r\n  white-space: nowrap;\r\n}\r\n\r\n.survey-table td {\r\n  padding: 1rem;\r\n  vertical-align: middle;\r\n}\r\n\r\n.no-results {\r\n  background-color: #fff;\r\n  border-radius: 12px;\r\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);\r\n}\r\n\r\n.btn-outline-primary {\r\n  color: #003366;\r\n  border-color: #003366;\r\n}\r\n\r\n.btn-outline-primary:hover {\r\n  background-color: #003366;\r\n  color: white;\r\n}\r\n\r\n/* Modal Styles */\r\n.modal-wrapper {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 1050;\r\n}\r\n\r\n.modal-backdrop {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  z-index: -1;\r\n}\r\n\r\n.modal-dialog {\r\n  max-width: 800px;\r\n  width: 100%;\r\n  margin: 1.75rem auto;\r\n}\r\n\r\n.modal-content {\r\n  border-radius: 12px;\r\n  overflow: hidden;\r\n  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.modal-header {\r\n  border-bottom: none;\r\n}\r\n\r\n.modal-title {\r\n  font-weight: 600;\r\n}\r\n\r\n.info-title {\r\n  font-size: 1.1rem;\r\n  font-weight: 600;\r\n  margin-bottom: 1rem;\r\n  color: #2d3748;\r\n  padding-bottom: 0.5rem;\r\n  border-bottom: 1px solid #e2e8f0;\r\n}\r\n\r\n.info-content {\r\n  padding: 0 0.5rem;\r\n}\r\n\r\n.info-content p {\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.chart-container {\r\n  min-height: 300px;\r\n  position: relative;\r\n}\r\n</style> "],"mappings":";;AAiKA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,KAAK;AAC9C,SAASC,QAAQ,QAAQ,MAAM;AAC/B,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,MAAM,MAAM,QAAQ;AAC3B,OAAOC,iBAAiB,MAAM,qCAAqC;;;;;;;IAEnE,MAAMC,KAAK,GAAGJ,QAAQ,CAAC,CAAC;IACxB,MAAMK,OAAO,GAAGR,GAAG,CAAC,EAAE,CAAC;IACvB,MAAMS,OAAO,GAAGT,GAAG,CAAC,IAAI,CAAC;IACzB,MAAMU,WAAW,GAAGV,GAAG,CAAC,EAAE,CAAC;IAC3B,MAAMW,cAAc,GAAGX,GAAG,CAAC,IAAI,CAAC;IAChC,MAAMY,oBAAoB,GAAGZ,GAAG,CAAC,KAAK,CAAC;;IAEvC;IACA,MAAMa,eAAe,GAAGZ,QAAQ,CAAC,MAAM;MACrC,IAAI,CAACS,WAAW,CAACI,KAAK,EAAE,OAAON,OAAO,CAACM,KAAK;MAE5C,MAAMC,KAAK,GAAGL,WAAW,CAACI,KAAK,CAACE,WAAW,CAAC,CAAC;MAC7C,OAAOR,OAAO,CAACM,KAAK,CAACG,MAAM,CAACC,MAAM,IAChCA,MAAM,CAACC,SAAS,CAACH,WAAW,CAAC,CAAC,CAACI,QAAQ,CAACL,KAAK,CAAC,IAC9CG,MAAM,CAACG,WAAW,CAACL,WAAW,CAAC,CAAC,CAACI,QAAQ,CAACL,KAAK,CACjD,CAAC;IACH,CAAC,CAAC;;IAEF;IACA,MAAMO,UAAU,GAAIC,UAAU,IAAK;MACjC,OAAOlB,MAAM,CAACkB,UAAU,CAAC,CAACC,MAAM,CAAC,oBAAoB,CAAC;IACxD,CAAC;;IAED;IACA,MAAMC,qBAAqB,GAAG,MAAAA,CAAA,KAAY;MACxC,IAAI;QACFhB,OAAO,CAACK,KAAK,GAAG,IAAI;QACpB,MAAMY,KAAK,GAAGnB,KAAK,CAACoB,KAAK,CAACC,IAAI,CAACF,KAAK;;QAEpC;QACA,MAAMG,QAAQ,GAAG,MAAMzB,KAAK,CAAC0B,GAAG,CAAC,4CAA4C,EAAE;UAC7EC,OAAO,EAAE;YAAE,eAAe,EAAE,UAAUL,KAAK;UAAG;QAChD,CAAC,CAAC;QAEF,IAAIG,QAAQ,CAACG,IAAI,EAAE;UACjBxB,OAAO,CAACM,KAAK,GAAGe,QAAQ,CAACG,IAAI;QAC/B;MACF,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,mCAAmC,EAAEA,KAAK,CAAC;QACzDzB,OAAO,CAACM,KAAK,GAAG,EAAE;MACpB,CAAC,SAAS;QACRL,OAAO,CAACK,KAAK,GAAG,KAAK;MACvB;IACF,CAAC;;IAED;IACA,MAAMqB,iBAAiB,GAAG,MAAOjB,MAAM,IAAK;MAC1C,IAAI;QACFN,oBAAoB,CAACE,KAAK,GAAG,IAAI;QACjCH,cAAc,CAACG,KAAK,GAAG;UACrB,GAAGI;QACL,CAAC;MACH,CAAC,CAAC,OAAOe,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;MACxD,CAAC,SAAS;QACRrB,oBAAoB,CAACE,KAAK,GAAG,KAAK;MACpC;IACF,CAAC;;IAED;IACA,MAAMsB,UAAU,GAAGA,CAAA,KAAM;MACvBzB,cAAc,CAACG,KAAK,GAAG,IAAI;IAC7B,CAAC;IAEDZ,SAAS,CAAC,MAAM;MACduB,qBAAqB,CAAC,CAAC;IACzB,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}